import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsClassifier

data = pd.read_csv("pgm4.csv")
X, y = data.iloc[:, :-1], data.iloc[:, -1]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)
scaler = StandardScaler().fit(X_train)
X_train, X_test = scaler.transform(X_train), scaler.transform(X_test)

for k in [1,3,5,7,9]:
    for w in ['uniform','distance']:
        acc = KNeighborsClassifier(k, weights=w).fit(X_train, y_train).score(X_test, y_test)
        print(f"k={k}, {'Weighted' if w=='distance' else 'Regular'} Accuracy: {acc:.4f}")
